displayName: latest.gcp-foundation.com      
orgPolicy:                                
- name: compute.disableNestedVirtualization
  spec:                                     
    rules:
    - enforce: true
- name: compute.disableSerialPortAccess
  spec:                                     
    rules:
    - enforce: true
- name: compute.disableGuestAttributesAccess
  spec:                                     
    rules:
    - enforce: true
- name: compute.skipDefaultNetworkCreation
  spec:                                     
    rules:
    - enforce: true
- name: compute.restrictXpnProjectLienRemoval
  spec:                                     
    rules:
    - enforce: true
- name: compute.disableVpcExternalIpv6
  spec:                                     
    rules:
    - enforce: true
- name: compute.setNewProjectDefaultToZonalDNSOnly
  spec:                                     
    rules:
    - enforce: true
- name: compute.requireOsLogin
  spec:                                     
    rules:
    - enforce: true
- name: sql.restrictPublicIp
  spec:                                     
    rules:
    - enforce: true
- name: sql.restrictAuthorizedNetworks
  spec:                                     
    rules:
    - enforce: true
- name: iam.disableServiceAccountKeyCreation
  spec:                                     
    rules:
    - enforce: true
- name: iam.automaticIamGrantsForDefaultServiceAccounts
  spec:                                     
    rules:
    - enforce: true
- name: iam.disableServiceAccountKeyUpload
  spec:                                     
    rules:
    - enforce: true
- name: storage.uniformBucketLevelAccess
  spec:                                     
    rules:
    - enforce: true
- name: storage.publicAccessPrevention
  spec:                                     
    rules:
    - enforce: true
folders:
- displayName : devops
  projects:
  - displayName: control
    services: 
    - cloudkms.googleapis.com             # - For CMEK keys
    - storage.googleapis.com              # - For storage buckets (terraform state)
    - cloudresourcemanager.googleapis.com # - Required for running terraform
    - serviceusage.googleapis.com         # - Required for running terraform 
    - iam.googleapis.com                  # - Required for running terraform
    - cloudbuild.googleapis.com           # - Required for running terraform
    - cloudasset.googleapis.com           # - Required for running terraform
    - orgpolicy.googleapis.com            # - Required for running terraform
    - compute.googleapis.com              # - Enabled by google
    - oslogin.googleapis.com              # - Enabled by google
  - displayName: pipelines
    services:       
    - serviceusage.googleapis.com         # - For enabling services 
    - cloudkms.googleapis.com             # - For CMEK keys
    - storage.googleapis.com              # - For storage buckets (cloudbuild outputs)
    - artifactregistry.googleapis.com     # - For docker images
    - sourcerepo.googleapis.com           # - For cloud source repositories
    - cloudbuild.googleapis.com           # - For cloud build triggers
    - compute.googleapis.com              # - Enabled by google
    - oslogin.googleapis.com              # - Enabled by google
    - logging.googleapis.com              # - Enabled by google - dependency on cloudbuild
    - pubsub.googleapis.com               # - Enabled by google - dependency on source repos
#    - containterregistry.googleapis.com  # - Enabled by google - dependency on cloudbuild?
    - storage-api.googleapis.com          # - Enabled by google - dependency on cloudbuild?
    - iam.googleapis.com                  # - Required for pipelines?
- displayName: management
  projects:
  - displayName: logging
    services: 
    - compute.googleapis.com              # - Enabled by google
    - oslogin.googleapis.com              # - Enabled by google
    - cloudkms.googleapis.com             # - For CMEK keys
  - displayName: billing
    services: 
    - compute.googleapis.com              # - Enabled by google
    - oslogin.googleapis.com              # - Enabled by google
  - displayName: guardrails
    services: 
    - compute.googleapis.com              # - Enabled by google
    - oslogin.googleapis.com              # - Enabled by google
    - cloudkms.googleapis.com             # - For CMEK keys
